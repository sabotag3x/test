<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Batalha de Filmes – IMDb Top 250</title>
<style>
body{margin:0;min-height:100vh;display:flex;justify-content:center;align-items:center;background:#0f0f0f;color:#fff;font-family:Arial,sans-serif}
.container{text-align:center;max-width:1100px;width:100%}
button{cursor:pointer;border:none;background:none;color:inherit}
.duel{display:flex;justify-content:center;gap:60px;margin-top:30px}
.card{width:340px}
.card img{width:100%;border-radius:10px;transition:transform .2s}
.card img:hover{transform:scale(1.05)}
.title{margin-top:10px;font-size:18px}
</style>
</head>
<body>

<div class="container">
  <h1>Batalha de Filmes – IMDb Top 250</h1>
  <button id="startBtn">Gerar competição</button>
  <div id="duel" class="duel"></div>
</div>

<script>
let filmes=[],index=0,vencedores=[],atual=[];
function shuffle(a){return a.sort(()=>Math.random()-.5)}
async function start(){
  const r=await fetch("/api/films");const d=await r.json();
  filmes=shuffle(d.films).slice(0,16);index=0;vencedores=[];
  next();
}
function next(){
  if(index>=filmes.length){
    filmes=vencedores;vencedores=[];index=0;
    if(filmes.length===1){
      document.getElementById("duel").innerHTML=`<h2>${filmes[0].title} (${filmes[0].year})</h2>`;return;
    }
    next();return;
  }
  atual=[filmes[index],filmes[index+1]];index+=2;
  document.getElementById("duel").innerHTML=card(atual[0],0)+card(atual[1],1);
}
function card(f,i){
  return `<div class="card"><button onclick="choose(${i})"><img src="${f.poster}"></button><div class="title">${f.title} (${f.year})</div></div>`;
}
function choose(i){vencedores.push(atual[i]);next()}
document.getElementById("startBtn").addEventListener("click",start);
</script>

</body>
</html>
