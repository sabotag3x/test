<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>IMDb â€“ Filmes Avaliados</title>

<style>
body {
  background:#000;
  color:#fff;
  font-family:Arial;
  padding:40px;
}
input, button {
  padding:10px;
  font-size:16px;
}
button {
  cursor:pointer;
}
table {
  margin-top:20px;
  width:100%;
  border-collapse:collapse;
}
th, td {
  border:1px solid #444;
  padding:8px;
}
#status {
  margin-top:15px;
  color:#ffcc00;
}
</style>
</head>

<body>

<h2>Buscar filmes avaliados no IMDb</h2>

<input id="userId" placeholder="urXXXXXXXX" value="ur55777575">
<button onclick="buscar()">Buscar</button>

<div id="status"></div>

<table id="table" style="display:none">
<thead>
<tr>
  <th>Filme</th>
  <th>Ano</th>
</tr>
</thead>
<tbody></tbody>
</table>

<script>
async function buscar() {
  const user = document.getElementById("userId").value.trim();
  const status = document.getElementById("status");
  const table = document.getElementById("table");
  const tbody = table.querySelector("tbody");

  status.textContent = "Buscando filmes...";
  table.style.display = "none";
  tbody.innerHTML = "";

  try {
    const res = await fetch(`/api/imdb/${user}`);
    const data = await res.json();

    if (!Array.isArray(data) || data.length === 0) {
      status.textContent = "Nenhum filme encontrado";
      return;
    }

    data.forEach(m => {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${m.title}</td><td>${m.year}</td>`;
      tbody.appendChild(tr);
    });

    table.style.display = "table";
    status.textContent = `Encontrados ${data.length} filmes`;

  } catch (err) {
    console.error(err);
    status.textContent = "Erro ao buscar dados (veja o console)";
  }
}
</script>

</body>
</html>
